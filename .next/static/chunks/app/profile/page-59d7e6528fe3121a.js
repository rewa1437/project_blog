(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[636],{24055:(e,r,s)=>{"use strict";s.d(r,{default:()=>c});var t=s(95155),a=s(12115),l=s(6874),n=s.n(l);function c(){let[e,r]=(0,a.useState)(null),[s,l]=(0,a.useState)(!0),[c,o]=(0,a.useState)(!1);if((0,a.useEffect)(()=>{let e=localStorage.getItem("user");if(e){let s=JSON.parse(e);r(s),(async()=>{try{let e=await fetch("".concat("https://microfinance-backend-763l.onrender.com","/get_user/?user_id=").concat(s.user_id)),t=await e.json(),a={...s,...t};r(a),o(!0),l(!1)}catch(e){console.error("Error fetching user info:",e),l(!1)}})()}else l(!1)},[]),s)return(0,t.jsx)("div",{className:"flex items-center justify-center h-screen bg-gray-100",children:(0,t.jsx)("p",{children:"Loading..."})});let i=(null==e?void 0:e.rank)===1?"bg-gray-500":(null==e?void 0:e.rank)===2?"bg-blue-500":(null==e?void 0:e.rank)===3?"bg-green-500":(null==e?void 0:e.rank)===4?"bg-yellow-500":"bg-gray-500";return(0,t.jsx)("nav",{className:"bg-gray-800 text-white p-4 shadow-md",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto flex justify-between items-center space-x-6",children:[(0,t.jsx)("div",{className:"font-bold text-xl",children:"MicroFinance"}),(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)(n(),{href:"/",children:(0,t.jsx)("span",{className:"cursor-pointer",children:"Home"})}),(0,t.jsx)(n(),{href:"/blog",children:(0,t.jsx)("span",{className:"cursor-pointer",children:"Blog"})}),c?(0,t.jsx)(n(),{href:"/donate_us",children:(0,t.jsx)("span",{className:"cursor-pointer",children:"Donate"})}):(0,t.jsx)(n(),{href:"#",children:(0,t.jsx)("span",{className:"cursor-pointer",onClick:()=>{alert("กรุณาล็อคอินก่อนเข้าสู่หน้าสนับสนุน")},children:"Donate"})}),e?(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(n(),{href:"/profile",children:(0,t.jsx)("div",{className:"".concat(i," text-white p-2 rounded-md cursor-pointer hover:scale-101 transition-all"),children:e.username})}),(0,t.jsx)(n(),{href:"/",children:(0,t.jsx)("button",{className:"ml-4 bg-red-600 text-white px-4 py-2 rounded-md hover:scale-101",onClick:()=>{localStorage.removeItem("user"),r(null)},children:"Logout"})})]}):(0,t.jsx)(n(),{href:"/logins",children:(0,t.jsx)("button",{className:"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-500",children:"Login"})})]})]})})}},37853:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>n});var t=s(95155),a=s(12115),l=s(24055);function n(){let[e,r]=(0,a.useState)(null),[s,n]=(0,a.useState)(""),[c,o]=(0,a.useState)(""),[i,d]=(0,a.useState)(!1),u="https://microfinance-backend-763l.onrender.com",[m,h]=(0,a.useState)([]),[x,b]=(0,a.useState)(1);(0,a.useEffect)(()=>{let e=localStorage.getItem("user");e&&r(JSON.parse(e))},[]),(0,a.useEffect)(()=>{if(e){let r=async()=>{try{let e=await fetch("".concat(u,"/get_all_donations/")),r=await e.json();h(r.donations)}catch(e){console.error("Error fetching donations:",e)}};(async()=>{try{let r=await fetch("".concat(u,"/get_user_all/?user_id=").concat(e.user_id)),s=await r.json();n(s)}catch(e){console.error("Error fetching user data:",e)}})(),r()}},[e]);let p=async()=>{if(c!==s.username){d(!0);try{let r=await fetch("".concat(u,"/update_username/"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:e.user_id,username:c})});(await r.json()).success?(alert("เปลี่ยนชื่อเรียบร้อย"),n(e=>({...e,username:c})),window.location.reload()):alert("ไม่มีการอัพเดท")}catch(e){console.error("Error updating username:",e),alert("Error updating username.")}finally{d(!1)}}else alert("ไม่มีการอัพเดท")},g=async()=>{if(window.confirm("Are you sure you want to delete your account?"))try{let r=await fetch("".concat(u,"/delete_user/"),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:e.user_id})});(await r.json()).success?(alert("User deleted successfully!"),localStorage.removeItem("user"),window.location.href="/"):alert("Failed to delete user.")}catch(e){console.error("Error deleting user:",e),alert("Error deleting user.")}},f=m.filter(r=>r.user_id===(null==e?void 0:e.user_id)),j=5*x,y=f.slice(j-5,j),N=Math.ceil(f.length/5);m.filter(r=>r.user_id===e.user_id);let w=(null==s?void 0:s.rank)===1?"ผู้สนับสนุนระดับนักผจญภัย":(null==s?void 0:s.rank)===2?"ผู้สนับสนุนระดับจอมยุทธ":(null==s?void 0:s.rank)===3?"ผู้สนับสนุนระดับวีรบุรุษ":(null==s?void 0:s.rank)===4?"ผู้สนับสนุนระดับตำนาน":"ผู้สนับสนุนระดับนักผจญภัย";return(0,t.jsxs)("div",{className:"h-full bg-gray-100 flex flex-col",children:[(0,t.jsx)(l.default,{}),(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-4",children:[(0,t.jsxs)("div",{className:"container p-8 bg-white shadow-md rounded-lg max-w-sm w-full mt-10",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-center text-green-600 mb-4",children:"My Account"}),(0,t.jsxs)("div",{className:"",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-2 text-center",children:"Account Details"}),(0,t.jsxs)("div",{className:"mb-4  items-center",children:[(0,t.jsx)("label",{htmlFor:"username",className:"block text-lg font-semibold mb-2 mr-4",children:"Username:"}),(0,t.jsx)("input",{type:"text",id:"username",className:"w-full p-3 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500",value:c,onChange:e=>{o(e.target.value)},placeholder:s.username})]}),(0,t.jsx)("p",{className:"text-lg font-semibold mb-2",children:"Email"}),(0,t.jsxs)("p",{className:"text-lg  mb-2",children:[" ",s.email]}),(0,t.jsx)("p",{className:"text-lg font-semibold mb-4",children:"Rank"}),(0,t.jsxs)("p",{className:"text-lg  mb-2",children:[" ",w]}),(0,t.jsxs)("div",{className:"mt-4 text-center flex space-x-4 items-center justify-center",children:[(0,t.jsx)("button",{onClick:p,className:"bg-gray-600 text-white px-6 py-2 rounded-md ".concat(i?"opacity-50 cursor-not-allowed":""),disabled:i,children:"Save"}),(0,t.jsx)("button",{onClick:g,className:"bg-red-600 text-white px-6 py-2 rounded-md ".concat(i?"opacity-50 cursor-not-allowed":""),disabled:i,children:"Delete"})]})]})]}),(0,t.jsxs)("div",{style:{width:600,marginTop:20},className:"bg-white shadow-md rounded-lg p-10",children:[(0,t.jsx)("h2",{className:"text-3xl font-bold text-center text-green-600 mb-4",children:"Donate History"}),(0,t.jsxs)("table",{className:"min-w-full border-collapse border border-gray-300",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"border border-gray-300 px-4 py-2",children:"Timestamp"}),(0,t.jsx)("th",{className:"border border-gray-300 px-4 py-2",children:"Product Name"}),(0,t.jsx)("th",{className:"border border-gray-300 px-4 py-2",children:"Amount"})]})}),(0,t.jsxs)("tbody",{children:[y.map((e,r)=>{var s;return(0,t.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"border border-gray-300 px-4 py-2",children:e.timestamp}),(0,t.jsx)("td",{className:"border border-gray-300 px-4 py-2",children:e.product_name}),(0,t.jsx)("td",{className:"border border-gray-300 px-4 py-2 text-right",children:e.amount})]},null!=(s=e.id)?s:r)}),0===y.length&&(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:"3",className:"text-center py-4",children:"No donations found."})})]})]}),(0,t.jsxs)("div",{className:"flex justify-between mt-3",children:[(0,t.jsx)("button",{onClick:()=>{x>1&&b(x-1)},disabled:1===x,className:"px-3 py-1 bg-gray-300 rounded disabled:opacity-50",children:"Prev"}),(0,t.jsxs)("span",{className:"self-center",children:["Page ",x," of ",N]}),(0,t.jsx)("button",{onClick:()=>{x<N&&b(x+1)},disabled:x===N||0===N,className:"px-3 py-1 bg-gray-300 rounded disabled:opacity-50",children:"Next"})]})]})]})]})}},77500:(e,r,s)=>{Promise.resolve().then(s.bind(s,37853))}},e=>{var r=r=>e(e.s=r);e.O(0,[874,441,684,358],()=>r(77500)),_N_E=e.O()}]);