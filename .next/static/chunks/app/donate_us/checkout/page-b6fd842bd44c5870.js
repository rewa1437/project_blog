(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[610],{7753:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var r=s(95155),a=s(12115),n=s(24055);function l(){let[e,t]=(0,a.useState)(null),[s,l]=(0,a.useState)(null),[c,i]=(0,a.useState)(null),o="https://microfinance-backend-763l.onrender.com";(0,a.useEffect)(()=>{let e=localStorage.getItem("selectedProductId");e&&(async()=>{try{let s=await fetch("".concat(o,"/get_product_details/").concat(e,"/")),r=await s.json();if(r.id)t(r);else throw Error("Product not found")}catch(e){i(e.message)}})()},[]),(0,a.useEffect)(()=>{let e=JSON.parse(localStorage.getItem("user")),t=null==e?void 0:e.user_id;t&&(async()=>{try{let e=await fetch("".concat(o,"/get_user/?user_id=").concat(t)),s=await e.json();l({user_id:t,...s})}catch(e){console.error("Error fetching user info:",e)}})()},[]);let d=async t=>{if(t.preventDefault(),!(null==s?void 0:s.user_id))return void alert("กรุณาเข้าสู่ระบบก่อนทำการบริจาค");let r=new FormData(t.target),a=r.get("fullname"),n=r.get("email"),l=r.get("phone");try{let t=await fetch("".concat(o,"/add_donation/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:s.user_id,product_id:e.id,amount:e.product_price,note:"ชื่อ: ".concat(a,", อีเมล: ").concat(n,", เบอร์: ").concat(l)})}),r=await t.json();if(r.success){let t=e.product_rank;t>s.rank&&await fetch("".concat(o,"/update_rank/"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:s.user_id,rank:t})}),alert("ขอบคุณสำหรับการบริจาค!"),window.location.href="/"}else alert("เกิดข้อผิดพลาด: "+r.message)}catch(e){console.error("Error submitting donation:",e),alert("ไม่สามารถทำรายการได้")}};return c?(0,r.jsx)("div",{className:"flex items-center justify-center h-screen bg-gray-100",children:(0,r.jsx)("p",{children:c})}):e&&s?(1===e.product_rank||2===e.product_rank||3===e.product_rank||e.product_rank,(0,r.jsxs)("div",{className:"h-auto",children:[(0,r.jsx)(n.default,{}),(0,r.jsxs)("div",{className:"p-8",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold text-center",children:"Checkout"}),(0,r.jsxs)("div",{className:"mt-8 flex gap-x-8",children:[(0,r.jsx)("div",{className:"w-3/10"}),(0,r.jsxs)("div",{className:"w-4/10 p-6",children:[(0,r.jsx)("h3",{className:"text-2xl font-semibold",children:"Order Form"}),(0,r.jsxs)("form",{className:"mt-4",onSubmit:d,children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Full Name / กรอกชื่อ-นามสกุล"}),(0,r.jsx)("input",{name:"fullname",type:"text",className:"w-full p-2 mt-1 border rounded-md",placeholder:"Enter your name",required:!0})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Email / อีเมล"}),(0,r.jsx)("input",{name:"email",type:"email",className:"w-full p-2 mt-1 border rounded-md",placeholder:"Enter your email",required:!0})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Phone Number / เบอร์โทรศัพท์"}),(0,r.jsx)("input",{name:"phone",type:"tel",className:"w-full p-2 mt-1 border rounded-md",placeholder:"Enter your phone number",required:!0})]}),(0,r.jsx)("div",{className:"mt-8",children:(0,r.jsxs)("div",{className:"flex gap-10",children:[(0,r.jsxs)("p",{className:"font-semibold",children:["Total: ",e.product_price," ฿"]}),(0,r.jsx)("button",{type:"submit",className:"bg-green-600 text-white px-6 py-2 rounded-md hover:bg-green-500",children:"Confirm Donation"})]})})]})]}),(0,r.jsx)("div",{className:"w-3/10"})]})]}),(0,r.jsx)("footer",{className:"text-center p-4 mt-8 text-gray-500 text-sm",children:"\xa9 2025, Microfinance"})]})):(0,r.jsx)("div",{className:"flex items-center justify-center h-screen bg-gray-100",children:(0,r.jsx)("p",{children:"Loading..."})})}},24055:(e,t,s)=>{"use strict";s.d(t,{default:()=>c});var r=s(95155),a=s(12115),n=s(6874),l=s.n(n);function c(){let[e,t]=(0,a.useState)(null),[s,n]=(0,a.useState)(!0),[c,i]=(0,a.useState)(!1);if((0,a.useEffect)(()=>{let e=localStorage.getItem("user");if(e){let s=JSON.parse(e);t(s),(async()=>{try{let e=await fetch("".concat("https://microfinance-backend-763l.onrender.com","/get_user/?user_id=").concat(s.user_id)),r=await e.json(),a={...s,...r};t(a),i(!0),n(!1)}catch(e){console.error("Error fetching user info:",e),n(!1)}})()}else n(!1)},[]),s)return(0,r.jsx)("div",{className:"flex items-center justify-center h-screen bg-gray-100",children:(0,r.jsx)("p",{children:"Loading..."})});let o=(null==e?void 0:e.rank)===1?"bg-gray-500":(null==e?void 0:e.rank)===2?"bg-blue-500":(null==e?void 0:e.rank)===3?"bg-green-500":(null==e?void 0:e.rank)===4?"bg-yellow-500":"bg-gray-500";return(0,r.jsx)("nav",{className:"bg-gray-800 text-white p-4 shadow-md",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto flex justify-between items-center space-x-6",children:[(0,r.jsx)("div",{className:"font-bold text-xl",children:"MicroFinance"}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)(l(),{href:"/",children:(0,r.jsx)("span",{className:"cursor-pointer",children:"Home"})}),(0,r.jsx)(l(),{href:"/blog",children:(0,r.jsx)("span",{className:"cursor-pointer",children:"Blog"})}),c?(0,r.jsx)(l(),{href:"/donate_us",children:(0,r.jsx)("span",{className:"cursor-pointer",children:"Donate"})}):(0,r.jsx)(l(),{href:"#",children:(0,r.jsx)("span",{className:"cursor-pointer",onClick:()=>{alert("กรุณาล็อคอินก่อนเข้าสู่หน้าสนับสนุน")},children:"Donate"})}),e?(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(l(),{href:"/profile",children:(0,r.jsx)("div",{className:"".concat(o," text-white p-2 rounded-md cursor-pointer hover:scale-101 transition-all"),children:e.username})}),(0,r.jsx)(l(),{href:"/",children:(0,r.jsx)("button",{className:"ml-4 bg-red-600 text-white px-4 py-2 rounded-md hover:scale-101",onClick:()=>{localStorage.removeItem("user"),t(null)},children:"Logout"})})]}):(0,r.jsx)(l(),{href:"/logins",children:(0,r.jsx)("button",{className:"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-500",children:"Login"})})]})]})})}},24097:(e,t,s)=>{Promise.resolve().then(s.bind(s,7753))}},e=>{var t=t=>e(e.s=t);e.O(0,[874,441,684,358],()=>t(24097)),_N_E=e.O()}]);