{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 39, "column": 0}, "map": {"version":3,"sources":["file:///Users/anupappasakornhiran/Desktop/project_blog/app/components/Navbar.js"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport Link from 'next/link';\n\nexport default function Navbar() {\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [isLogin, setlogin] =  useState(false);\n\n  useEffect(() => {\n    const storedUser = localStorage.getItem('user');\n    if (storedUser) {\n      const parsedUser = JSON.parse(storedUser);\n      setUser(parsedUser); \n\n      const fetchUserInfo = async () => {\n        try {\n          const userResponse = await fetch(`http://127.0.0.1:8000/get_user/?user_id=${parsedUser.user_id}`);\n          const userInfo = await userResponse.json();\n\n          const completeUserData = { ...parsedUser, ...userInfo };\n          setUser(completeUserData);\n          setlogin(true);\n          setLoading(false);\n        } catch (error) {\n          console.error('Error fetching user info:', error);\n          setLoading(false);\n        }\n      };\n\n      fetchUserInfo();\n    } else {\n      setLoading(false);\n    }\n  }, []);\n\n  const handleLogout = () => {\n    localStorage.removeItem('user');\n    setUser(null);\n    window.location.reload();\n  };\n\n  const handleLoginfirst = () => {\n    alert(\"กรุณาล็อคอินก่อนเข้าสู่หน้าสนับสนุน\")\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center h-screen bg-gray-100\">\n        <p>Loading...</p>\n      </div>\n    );\n  }\n\n  const rankClass = user?.rank === 1 ? 'bg-gray-500' :\n                    user?.rank === 2 ? 'bg-blue-500' :\n                    user?.rank === 3 ? 'bg-green-500' :\n                    user?.rank === 4 ? 'bg-yellow-500' :\n                    'bg-gray-500';\n\n  return (\n    <nav className=\"bg-gray-800 text-white p-4 shadow-md\">\n      <div className=\"max-w-7xl mx-auto flex justify-between items-center space-x-6\">\n        <div className=\"font-bold text-xl\">MicroFinance</div>\n\n        <div className=\"flex items-center space-x-4\">\n          <Link href=\"/\">\n            <span className=\"cursor-pointer\">Home</span>\n          </Link>\n\n          <Link href=\"/blog\">\n            <span className=\"cursor-pointer\">Blog</span>\n          </Link>\n          {isLogin ?(\n              <Link href=\"/donate_us\">\n                <span className=\"cursor-pointer\">Donate</span>\n              </Link>\n            ):(\n              <Link href=\"#\">\n                <span className=\"cursor-pointer\" onClick={handleLoginfirst}>Donate</span>\n              </Link>\n            )}\n\n          {user ? (\n            <div className=\"flex items-center\">\n              <Link href=\"/profile\">\n                <div className={`${rankClass} text-white p-2 rounded-md cursor-pointer hover:scale-101 transition-all`}>\n                  {user.username}\n                </div>\n              </Link>\n              <Link href=\"/\">\n                <button\n                  className=\"ml-4 bg-red-600 text-white px-4 py-2 rounded-md hover:scale-101\"\n                  onClick={handleLogout}\n                >\n                  Logout\n                </button>\n              </Link>\n            </div>\n          ) : (\n            <Link href=\"/logins\">\n              <button className=\"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-500\">\n                Login\n              </button>\n            </Link>\n          )}\n        </div>\n      </div>\n    </nav>\n  );\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AAHA;;;;AAKe,SAAS;IACtB,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACjC,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,CAAC,SAAS,SAAS,GAAI,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAEtC,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,aAAa,aAAa,OAAO,CAAC;QACxC,IAAI,YAAY;YACd,MAAM,aAAa,KAAK,KAAK,CAAC;YAC9B,QAAQ;YAER,MAAM,gBAAgB;gBACpB,IAAI;oBACF,MAAM,eAAe,MAAM,MAAM,CAAC,wCAAwC,EAAE,WAAW,OAAO,EAAE;oBAChG,MAAM,WAAW,MAAM,aAAa,IAAI;oBAExC,MAAM,mBAAmB;wBAAE,GAAG,UAAU;wBAAE,GAAG,QAAQ;oBAAC;oBACtD,QAAQ;oBACR,SAAS;oBACT,WAAW;gBACb,EAAE,OAAO,OAAO;oBACd,QAAQ,KAAK,CAAC,6BAA6B;oBAC3C,WAAW;gBACb;YACF;YAEA;QACF,OAAO;YACL,WAAW;QACb;IACF,GAAG,EAAE;IAEL,MAAM,eAAe;QACnB,aAAa,UAAU,CAAC;QACxB,QAAQ;QACR,OAAO,QAAQ,CAAC,MAAM;IACxB;IAEA,MAAM,mBAAmB;QACvB,MAAM;IACR;IAEA,IAAI,SAAS;QACX,qBACE,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;0BAAE;;;;;;;;;;;IAGT;IAEA,MAAM,YAAY,MAAM,SAAS,IAAI,gBACnB,MAAM,SAAS,IAAI,gBACnB,MAAM,SAAS,IAAI,iBACnB,MAAM,SAAS,IAAI,kBACnB;IAElB,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAI,WAAU;8BAAoB;;;;;;8BAEnC,8OAAC;oBAAI,WAAU;;sCACb,8OAAC,4JAAA,CAAA,UAAI;4BAAC,MAAK;sCACT,cAAA,8OAAC;gCAAK,WAAU;0CAAiB;;;;;;;;;;;sCAGnC,8OAAC,4JAAA,CAAA,UAAI;4BAAC,MAAK;sCACT,cAAA,8OAAC;gCAAK,WAAU;0CAAiB;;;;;;;;;;;wBAElC,wBACG,8OAAC,4JAAA,CAAA,UAAI;4BAAC,MAAK;sCACT,cAAA,8OAAC;gCAAK,WAAU;0CAAiB;;;;;;;;;;iDAGnC,8OAAC,4JAAA,CAAA,UAAI;4BAAC,MAAK;sCACT,cAAA,8OAAC;gCAAK,WAAU;gCAAiB,SAAS;0CAAkB;;;;;;;;;;;wBAIjE,qBACC,8OAAC;4BAAI,WAAU;;8CACb,8OAAC,4JAAA,CAAA,UAAI;oCAAC,MAAK;8CACT,cAAA,8OAAC;wCAAI,WAAW,GAAG,UAAU,wEAAwE,CAAC;kDACnG,KAAK,QAAQ;;;;;;;;;;;8CAGlB,8OAAC,4JAAA,CAAA,UAAI;oCAAC,MAAK;8CACT,cAAA,8OAAC;wCACC,WAAU;wCACV,SAAS;kDACV;;;;;;;;;;;;;;;;iDAML,8OAAC,4JAAA,CAAA,UAAI;4BAAC,MAAK;sCACT,cAAA,8OAAC;gCAAO,WAAU;0CAAgE;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAShG","debugId":null}},
    {"offset": {"line": 258, "column": 0}, "map": {"version":3,"sources":["file:///Users/anupappasakornhiran/Desktop/project_blog/app/donate_us/checkout/page.js"],"sourcesContent":["'use client'; \n\nimport { useEffect, useState } from 'react';\nimport Navbar from '@/app/components/Navbar';\n\nexport default function Checkout() {\n  const [product, setProduct] = useState(null);\n  const [user, setUser] = useState(null); // ✅ เก็บข้อมูล user พร้อม rank สด\n  const [error, setError] = useState(null);\n\n  // ✅ ดึงข้อมูลสินค้า\n  useEffect(() => {\n    const productId = localStorage.getItem(\"selectedProductId\"); \n\n    if (productId) {\n      const fetchProductData = async () => {\n        try {\n          const response = await fetch(`http://127.0.0.1:8000/get_product_details/${productId}/`);\n          const data = await response.json();\n          if (data.id) setProduct(data);\n          else throw new Error('Product not found');\n        } catch (error) {\n          setError(error.message);\n        }\n      };\n      fetchProductData();\n    }\n  }, []);\n\n  // ✅ ดึงข้อมูล user โดยใช้ user_id ที่ได้จาก localStorage\n  useEffect(() => {\n    const storedUser = JSON.parse(localStorage.getItem(\"user\"));\n    const userId = storedUser?.user_id;\n\n    if (userId) {\n      const fetchUserInfo = async () => {\n        try {\n          const response = await fetch(`http://127.0.0.1:8000/get_user/?user_id=${userId}`);\n          const userInfo = await response.json();\n          setUser({ user_id: userId, ...userInfo });\n        } catch (error) {\n          console.error(\"Error fetching user info:\", error);\n        }\n      };\n      fetchUserInfo();\n    }\n  }, []);\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    if (!user?.user_id) {\n      alert(\"กรุณาเข้าสู่ระบบก่อนทำการบริจาค\");\n      return;\n    }\n\n    const formData = new FormData(e.target);\n    const fullName = formData.get(\"fullname\");\n    const email = formData.get(\"email\");\n    const phone = formData.get(\"phone\");\n\n    try {\n      const donateRes = await fetch(\"http://127.0.0.1:8000/add_donation/\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({\n          user_id: user.user_id,\n          product_id: product.id,\n          amount: product.product_price,\n          note: `ชื่อ: ${fullName}, อีเมล: ${email}, เบอร์: ${phone}`,\n        }),\n      });\n\n      const donateData = await donateRes.json();\n\n      if (donateData.success) {\n        const newRank = product.product_rank;\n\n        if (newRank > user.rank) {\n          await fetch(\"http://127.0.0.1:8000/update_rank/\", {\n            method: \"PUT\",\n            headers: {\n              \"Content-Type\": \"application/json\",\n            },\n            body: JSON.stringify({\n              user_id: user.user_id,\n              rank: newRank,\n            }),\n          });\n        }\n\n        alert(\"ขอบคุณสำหรับการบริจาค!\");\n        window.location.href = \"/\";\n      } else {\n        alert(\"เกิดข้อผิดพลาด: \" + donateData.message);\n      }\n    } catch (error) {\n      console.error(\"Error submitting donation:\", error);\n      alert(\"ไม่สามารถทำรายการได้\");\n    }\n  };\n\n  // ✅ แสดง error\n  if (error) {\n    return (\n      <div className=\"flex items-center justify-center h-screen bg-gray-100\">\n        <p>{error}</p>\n      </div>\n    );\n  }\n\n  // ✅ แสดง loading\n  if (!product || !user) {\n    return (\n      <div className=\"flex items-center justify-center h-screen bg-gray-100\">\n        <p>Loading...</p>\n      </div>\n    );\n  }\n\n  const rankClass = product.product_rank === 1 ? 'ได้รับพื้นหลังโปรไฟล์เป็นสีเทา' :\n                    product.product_rank === 2 ? 'ได้รับพื้นหลังโปรไฟล์เป็นสีฟ้า' :\n                    product.product_rank === 3 ? 'ได้รับพื้นหลังโปรไฟล์เป็นสีเขียว' :\n                    product.product_rank === 4 ? 'ได้รับพื้นหลังโปรไฟล์เป็นสีเหลือง' :\n                    'ได้รับพื้นหลังโปรไฟล์เป็นสีเทา';\n\n  return (\n    <div className=\"h-auto\">\n      <Navbar />\n      <div className=\"p-8\">\n        <h1 className=\"text-4xl font-bold text-center\">Checkout</h1>\n\n        <div className=\"mt-8 flex gap-x-8\">\n          <div className=\"w-10/10 p-6\">\n            <h3 className=\"text-2xl font-semibold\">Product: {product.product_name}</h3>\n            <br />\n            <p><strong>Price:</strong> {product.product_price} ฿</p>\n            <br />\n            <p><strong>Description:</strong> {product.product_description}</p>\n            <br />\n            <p><strong>Rank:</strong> {rankClass}</p>\n          </div>\n\n          <div className=\"w-1/10\"></div>\n\n          <div className=\"w-3/4 p-6\">\n            <h3 className=\"text-2xl font-semibold\">Order Form</h3>\n            <form className=\"mt-4\" onSubmit={handleSubmit}>\n              <div className=\"mb-4\">\n                <label className=\"block text-sm font-medium\">Full Name</label>\n                <input name=\"fullname\" type=\"text\" className=\"w-full p-2 mt-1 border rounded-md\" placeholder=\"Enter your name\" required />\n              </div>\n              <div className=\"mb-4\">\n                <label className=\"block text-sm font-medium\">Email</label>\n                <input name=\"email\" type=\"email\" className=\"w-full p-2 mt-1 border rounded-md\" placeholder=\"Enter your email\" required/>\n              </div>\n              <div className=\"mb-4\">\n                <label className=\"block text-sm font-medium\">Phone Number</label>\n                <input name=\"phone\" type=\"tel\" className=\"w-full p-2 mt-1 border rounded-md\" placeholder=\"Enter your phone number\" required />\n              </div>\n              <div className=\"mt-8\">\n                <div className=\"flex justify-between\">\n                  <p className=\"font-semibold\">Total: {product.product_price} ฿</p>\n                  <button type=\"submit\" className=\"bg-green-600 text-white px-6 py-2 rounded-md hover:bg-green-500\">\n                    Confirm Donation\n                  </button>\n                </div>\n              </div>\n            </form>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}